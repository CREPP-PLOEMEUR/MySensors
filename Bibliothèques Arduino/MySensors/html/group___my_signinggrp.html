<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: MySigning</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">MySigning<div class="ingroups"><a class="el" href="group__internals.html">MySensors internal APIs and functionalities</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>API declaration for MySigning signing backend.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for MySigning:</div>
<div class="dyncontent">
<div class="center"><img src="group___my_signinggrp.png" border="0" usemap="#group______my__signinggrp" alt=""/></div>
<map name="group______my__signinggrp" id="group______my__signinggrp">
<area shape="rect" href="group__internals.html" title="The interal APIs and functionalities should only be used by library developers/advanced users." alt="" coords="5,5,184,45"/>
<area shape="rect" title="API declaration for MySigning signing backend." alt="" coords="232,13,323,38"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:_my_signing_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_my_signing_8h.html">MySigning.h</a></td></tr>
<tr class="memdesc:_my_signing_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">API declaration for MySigning signing backend. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gad808f977970b4fa7871439fd8a90720a"><td class="memItemLeft" align="right" valign="top"><a id="gad808f977970b4fa7871439fd8a90720a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#gad808f977970b4fa7871439fd8a90720a">NUM_OF</a>(x)&#160;&#160;&#160;(sizeof(x)/sizeof(x[0]))</td></tr>
<tr class="memdesc:gad808f977970b4fa7871439fd8a90720a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper macro to determine the number of elements in a array. <br /></td></tr>
<tr class="separator:gad808f977970b4fa7871439fd8a90720a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1657c9d0b3d749a3889389daa25adc26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#ga1657c9d0b3d749a3889389daa25adc26">signerInit</a> (void)</td></tr>
<tr class="memdesc:ga1657c9d0b3d749a3889389daa25adc26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes signing infrastructure and associated backend.  <a href="group___my_signinggrp.html#ga1657c9d0b3d749a3889389daa25adc26">More...</a><br /></td></tr>
<tr class="separator:ga1657c9d0b3d749a3889389daa25adc26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c8b87323fc0b1b7f657721c8df2f563"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#ga0c8b87323fc0b1b7f657721c8df2f563">signerPresentation</a> (MyMessage &amp;msg, uint8_t destination)</td></tr>
<tr class="memdesc:ga0c8b87323fc0b1b7f657721c8df2f563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does signing specific presentation for a node.  <a href="group___my_signinggrp.html#ga0c8b87323fc0b1b7f657721c8df2f563">More...</a><br /></td></tr>
<tr class="separator:ga0c8b87323fc0b1b7f657721c8df2f563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd46648ae769964c6b29387d346e0a16"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#gafd46648ae769964c6b29387d346e0a16">signerProcessInternal</a> (MyMessage &amp;msg)</td></tr>
<tr class="memdesc:gafd46648ae769964c6b29387d346e0a16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages internal signing message handshaking.  <a href="group___my_signinggrp.html#gafd46648ae769964c6b29387d346e0a16">More...</a><br /></td></tr>
<tr class="separator:gafd46648ae769964c6b29387d346e0a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedf132015e60641bc0333038c4af0b08"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#gaedf132015e60641bc0333038c4af0b08">signerCheckTimer</a> (void)</td></tr>
<tr class="memdesc:gaedf132015e60641bc0333038c4af0b08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check timeout of verification session.  <a href="group___my_signinggrp.html#gaedf132015e60641bc0333038c4af0b08">More...</a><br /></td></tr>
<tr class="separator:gaedf132015e60641bc0333038c4af0b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa30a2d91d457e5372ff6d9b2e71181b4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#gaa30a2d91d457e5372ff6d9b2e71181b4">signerPutNonce</a> (MyMessage &amp;msg)</td></tr>
<tr class="memdesc:gaa30a2d91d457e5372ff6d9b2e71181b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get nonce from provided message and store for signing operations.  <a href="group___my_signinggrp.html#gaa30a2d91d457e5372ff6d9b2e71181b4">More...</a><br /></td></tr>
<tr class="separator:gaa30a2d91d457e5372ff6d9b2e71181b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga082cdea28ce10b254a2f7fe75ef2d9d4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#ga082cdea28ce10b254a2f7fe75ef2d9d4">signerSignMsg</a> (MyMessage &amp;msg)</td></tr>
<tr class="memdesc:ga082cdea28ce10b254a2f7fe75ef2d9d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signs provided message. All remaining space in message payload buffer is used for signing identifier and signature.  <a href="group___my_signinggrp.html#ga082cdea28ce10b254a2f7fe75ef2d9d4">More...</a><br /></td></tr>
<tr class="separator:ga082cdea28ce10b254a2f7fe75ef2d9d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1d71a329977692267cff3d3dc5bcbe89"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#ga1d71a329977692267cff3d3dc5bcbe89">signerVerifyMsg</a> (MyMessage &amp;msg)</td></tr>
<tr class="memdesc:ga1d71a329977692267cff3d3dc5bcbe89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies signature in provided message.  <a href="group___my_signinggrp.html#ga1d71a329977692267cff3d3dc5bcbe89">More...</a><br /></td></tr>
<tr class="separator:ga1d71a329977692267cff3d3dc5bcbe89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab83a29a358719085c6fb33d18488c94c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___my_signinggrp.html#gab83a29a358719085c6fb33d18488c94c">signerMemcmp</a> (const void *a, const void *b, size_t sz)</td></tr>
<tr class="memdesc:gab83a29a358719085c6fb33d18488c94c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do a timing neutral memory comparison.  <a href="group___my_signinggrp.html#gab83a29a358719085c6fb33d18488c94c">More...</a><br /></td></tr>
<tr class="separator:gab83a29a358719085c6fb33d18488c94c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>API declaration for MySigning signing backend. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___my_signinggrp_pub.html" title="The message signing infrastructure provides message authenticity to users by signing MySensors messag...">Message signing</a> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaedf132015e60641bc0333038c4af0b08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaedf132015e60641bc0333038c4af0b08">&#9670;&nbsp;</a></span>signerCheckTimer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool signerCheckTimer </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check timeout of verification session. </p>
<p>Nonce will be purged if it takes too long for a signed message to be sent to the receiver. <br  />
<b>Usage:</b> This function should be called on regular intervals, typically within some process loop.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if session is still valid. </dd></dl>

</div>
</div>
<a id="ga1657c9d0b3d749a3889389daa25adc26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1657c9d0b3d749a3889389daa25adc26">&#9670;&nbsp;</a></span>signerInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void signerInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes signing infrastructure and associated backend. </p>
<p>This function makes sure that the internal states of the signing infrastructure is set to a known initial state. <br  />
<b>Usage:</b> This function should be called before any signing related operations take place. </p>

</div>
</div>
<a id="gab83a29a358719085c6fb33d18488c94c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab83a29a358719085c6fb33d18488c94c">&#9670;&nbsp;</a></span>signerMemcmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int signerMemcmp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do a timing neutral memory comparison. </p>
<p>The function behaves similar to memcmp with the difference that it will always use the same number of instructions for a given number of bytes, no matter how the two buffers differ and the response is either 0 or -1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First buffer for comparison. </td></tr>
    <tr><td class="paramname">b</td><td>Second buffer for comparison. </td></tr>
    <tr><td class="paramname">sz</td><td>The number of bytes to compare. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if buffers match, -1 if they do not. </dd></dl>

</div>
</div>
<a id="ga0c8b87323fc0b1b7f657721c8df2f563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c8b87323fc0b1b7f657721c8df2f563">&#9670;&nbsp;</a></span>signerPresentation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void signerPresentation </td>
          <td>(</td>
          <td class="paramtype">MyMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>destination</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does signing specific presentation for a node. </p>
<p>This function makes sure any signing related presentation info is shared with the other part. The presentation of the gateways signing preferences is done in <a class="el" href="group___my_signinggrp.html#gafd46648ae769964c6b29387d346e0a16">signerProcessInternal()</a>. <br  />
<b>Usage:</b> This function should be called by the presentation routine of the MySensors library. You only need to call this directly from a sketch to set up a node to node signed message exchange. If you do call this directly from a sketch, and you at some point change your sketch to go from requiring signing to not requiring signatures, you need to present this change to the node at least once, so it can update its requirements tables accordingly. Or it will keep believing that this node require signatures and attempt to send signed messages to it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message buffer to use. </td></tr>
    <tr><td class="paramname">destination</td><td>Node ID of the destination. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafd46648ae769964c6b29387d346e0a16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd46648ae769964c6b29387d346e0a16">&#9670;&nbsp;</a></span>signerProcessInternal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool signerProcessInternal </td>
          <td>(</td>
          <td class="paramtype">MyMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manages internal signing message handshaking. </p>
<p>This function takes care of signing related message handshaking such as nonce exchange. <br  />
<b>Usage:</b> This function should be called by the incoming message handler before any further message processing is performed on internal messages. This function should only be called for <a class="el" href="group___my_messagegrp.html#gga2f420202c4443624e5422b323271bf7faf1b3b222e462568c00c5a79284b03743">C_INTERNAL</a> class messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message buffer to process. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if caller should stop further message processing. </dd></dl>

</div>
</div>
<a id="gaa30a2d91d457e5372ff6d9b2e71181b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa30a2d91d457e5372ff6d9b2e71181b4">&#9670;&nbsp;</a></span>signerPutNonce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool signerPutNonce </td>
          <td>(</td>
          <td class="paramtype">MyMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get nonce from provided message and store for signing operations. </p>
<p>Returns <code>false</code> if subsystem is busy processing an ongoing signing operation.<br  />
 Returns <code>false</code> if signing identifier found in message is not supported by the used backend.<br  />
 If successful, this marks the start of a signing operation at the sending side so implementation is expected to do any necessary initializations within this call. <br  />
<b>Usage:</b> This function is typically called as action when receiving a <a class="el" href="group___my_messagegrp.html#gga5636ada210e2435e058d917640d32732a9f3e22de05e07ef93d35ecb69798fcdb">I_NONCE_RESPONSE</a> message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The message to get the nonce from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if successful, else <code>false</code>. </dd></dl>

</div>
</div>
<a id="ga082cdea28ce10b254a2f7fe75ef2d9d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga082cdea28ce10b254a2f7fe75ef2d9d4">&#9670;&nbsp;</a></span>signerSignMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool signerSignMsg </td>
          <td>(</td>
          <td class="paramtype">MyMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signs provided message. All remaining space in message payload buffer is used for signing identifier and signature. </p>
<p>Nonce used for signature calculation is the one generated previously within <a class="el" href="group___my_signinggrp.html#gafd46648ae769964c6b29387d346e0a16">signerProcessInternal()</a>.<br  />
 Nonce will be cleared when this function is called to prevent re-use of nonce.<br  />
 Returns <code>false</code> if subsystem is busy processing an ongoing signing operation.<br  />
 Returns <code>false</code> if not two bytes or more of free payload space is left in provided message.<br  />
 This ends a signing operation at the sending side so implementation is expected to do any deinitializations and enter a power saving state within this call. <br  />
<b>Usage:</b> This function is typically called as action when receiving a <a class="el" href="group___my_messagegrp.html#gga5636ada210e2435e058d917640d32732a9f3e22de05e07ef93d35ecb69798fcdb">I_NONCE_RESPONSE</a> message and after <a class="el" href="group___my_signinggrp.html#gaa30a2d91d457e5372ff6d9b2e71181b4">signerPutNonce()</a> has successfully been executed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The message to sign. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if successful, else <code>false</code>. </dd></dl>

</div>
</div>
<a id="ga1d71a329977692267cff3d3dc5bcbe89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1d71a329977692267cff3d3dc5bcbe89">&#9670;&nbsp;</a></span>signerVerifyMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool signerVerifyMsg </td>
          <td>(</td>
          <td class="paramtype">MyMessage &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies signature in provided message. </p>
<p>Nonce used for verification is the one previously set using <a class="el" href="group___my_signinggrp.html#gaa30a2d91d457e5372ff6d9b2e71181b4">signerPutNonce()</a>.<br  />
 Nonce will be cleared when this function is called to prevent re-use of nonce.<br  />
 Returns <code>false</code> if subsystem is busy processing an ongoing signing operation.<br  />
 Returns <code>false</code> if signing identifier found in message is not supported by the used backend.<br  />
 This ends a signing operation at the receiving side so implementation is expected to do any deinitializations and enter a power saving state within this call. <br  />
<b>Usage:</b> This function is typically called when receiving a message that is flagged as signed and MY_SIGNING_REQUEST_SIGNATURES is activated.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The message to verify. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if successful, else <code>false</code>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
